<dialog #codeModal id="kid_code_modal" class="modal modal-bottom sm:modal-middle">
	<div class="modal-box">
		<h3 class="text-lg font-bold text-center">
			@if (modalType === 'qr') { 
				QR Code
			} @else if (modalType === 'pin') { 
				PIN Code 
			}
			@if (selectedKid) { 
				<span class="font-normal"> - {{ selectedKid.name }}</span> 
			}
		</h3>

		<div class="py-4 space-y-4">
			@if (modalType === 'qr') {
				<div class="w-full flex flex-col items-center gap-4">
					@if (qrCodeDataUrl) {
						<div class="w-48 h-48 ring-1 ring-base-300 overflow-hidden bg-white p-1 rounded-lg">
							<img [src]="qrCodeDataUrl" alt="QR Code for {{ selectedKid?.name }}" class="w-full h-full object-contain">
						</div>
					} @else {
						<div class="w-48 h-48 ring-1 ring-base-300 rounded-lg grid place-items-center text-base-content/60 text-center text-sm">
							<div class="flex flex-col items-center gap-2">
								<span class="loading loading-spinner loading-md"></span>
								<span>Generating QR Code...</span>
							</div>
						</div>
					}
					<p class="text-m text-base-content/80 text-center">
						To add a child, scan the QR code in the mobile app.
					</p>
				</div>
			} @else if (modalType === 'pin') {
				<div class="w-full flex flex-col items-center gap-4">
					<div class="text-4xl font-mono tracking-widest bg-base-200 px-6 py-4 rounded-lg">
						{{ pin }}
					</div>
					<p class="text-m text-base-content/80 text-center">
						To add a child, enter the PIN code in the mobile app.
					</p>
				</div>
			}
		</div>
		<div class="modal-action">
			<button class="btn" (click)="close()">Close</button>
		</div>
	</div>
	<form method="dialog" class="modal-backdrop">
		<button (click)="close()"></button>
	</form>
</dialog>
